name: Daily PR TIMES Crawling

on:
  schedule:
    # í•œêµ­ ì‹œê°„(KST) ì˜¤ì „ 9ì‹œ (UTC 00:00)
    - cron: '0 0 * * *'
  workflow_dispatch: # ì§ì ‘ 'Run' ë²„íŠ¼ì„ ëˆŒëŸ¬ í…ŒìŠ¤íŠ¸í•´ë³¼ ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤.

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        # google-generativeai ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.
        pip install pandas playwright googletrans==4.0.0-rc1 google-generativeai

    - name: Install Playwright Browsers
      run: |
        playwright install chromium --with-deps

    - name: Run Crawler with Gemini
      env:
        Gemini_Git_API_Key: ${{ secrets.Gemini_Git_API_Key }}
      run: |
<<<<<<< HEAD
        # ì‹¤ì œ íŒŒì¼ëª…(ì˜ˆ: prtimes_beauty_today.py)ìœ¼ë¡œ ë°˜ë“œì‹œ ìˆ˜ì •í•˜ì„¸ìš”!
=======
>>>>>>> 4d71a3e (refactor: í¬ë¡¤ëŸ¬ ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ëª… ë³€ê²½ (prtimes_beauty_crawler.py â†’ prtimes_beauty_today.py))
        python prtimes_beauty_today.py 

    - name: Send Email with Date CSV ğŸŒ¸
      uses: dawidd6/action-send-mail@v3
      with:
        server_address: smtp.gmail.com
        server_port: 465
        username: ${{ secrets.MAIL_USERNAME }}
        password: ${{ secrets.MAIL_PASSWORD }}
        subject: "ğŸŒ¸ ì£¼ì¸ë‹˜! ì˜¤ëŠ˜ì ë·°í‹° ë‰´ìŠ¤ ë°°ë‹¬ì™”ì–´ìš”! ğŸŒ¸"
        body: |
          ì•ˆë…•í•˜ì„¸ìš”, ì£¼ì¸ë‹˜! ğŸ¤–
          ì˜¤ëŠ˜ë„ ì •ì„±ê» ìˆ˜ì§‘í•œ ë·°í‹° ë‰´ìŠ¤ CSV íŒŒì¼ì„ ì²¨ë¶€í•©ë‹ˆë‹¤.
          í–‰ë³µí•œ í•˜ë£¨ ë˜ì„¸ìš”! âœ¨
        to: ${{ secrets.MAIL_USERNAME }}
        from: "ëŒì•„ë¼ ì¼ë³¸ PR í¬ë¡¤ëŸ¬ ë´‡"
        attachments: "*.csv"
